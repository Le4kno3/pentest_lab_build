# Do not edit this file manually.
# This file is auto generated by ./lab.sh.
# To change this file edit files located in: "./etc/services/".
# Afterwards restart the lab.
version: '3.7'

# Basic function options
x-victim: &victim
  labels:
    class: 'victim'
    cluster: 'pentest_lab'
x-monitoring: &monitoring
  labels:
    class: 'monitoring'
    cluster: 'pentest_lab'
x-red_team: &red_team
  labels:
    class: 'red_team'
    cluster: 'pentest_lab'
x-blue_team: &blue_team
  labels:
    class: 'blue_team'
    cluster: 'pentest_lab'

networks:
  pentest_lab:
    driver: bridge
    ipam:
      config:
        - subnet: 10.5.0.0/24

services:
  # Default attack system.
  kali:
    <<: *red_team
    build:
      context: ./
      dockerfile: dockerfiles/kali
    networks:
      pentest_lab:
        ipv4_address: 10.5.0.5
    hostname: kali
    volumes:
      - kali-data:/root/Documents
  zap:
    <<: *red_team
    image: owasp/zap2docker-stable
    networks:
      pentest_lab:
        ipv4_address: 10.5.0.6
    hostname: zap
  endlessh:
    <<: *blue_team
    image: harshavardhanj/endlessh
    networks:
      pentest_lab:
        ipv4_address: 10.5.0.50
    hostname: endlessh
  prometheus:
    <<: *monitoring
    image: prom/prometheus
    networks:
      pentest_lab:
        ipv4_address: 10.5.0.201
    hostname: prometheus
    volumes:
      - prometheus-data:/prometheus
  grafana:
    <<: *monitoring
    image: grafana/grafana
    ports:
      - '3300:3000'
    networks:
      pentest_lab:
        ipv4_address: 10.5.0.200
    hostname: grafana
    volumes:
      - grafana-data:/var/lib/grafana
  bwapp:
    labels:
      class: 'victim'
      cluster: 'pentest_lab'
      level: 'beginner'
    image: raesene/bwapp
    ports:
      - '8080:80'
    networks:
      pentest_lab:
        ipv4_address: 10.5.0.100
    hostname: bwapp
    volumes:
      - bwapp-data:/var/lib/mysql
  dvwa:
    labels:
      class: 'victim'
      cluster: 'pentest_lab'
      level: 'beginner'
    image: vulnerables/web-dvwa
    ports:
      - '9000:80'
    networks:
      pentest_lab:
        ipv4_address: 10.5.0.101
    hostname: dvwa
  webgoat:
    labels:
      class: 'victim'
      cluster: 'pentest_lab'
      level: 'beginner'
    image: webgoat/goatandwolf
    ports:
      - '8001:8080'
      - '8002:9090'
    environment:
      - TZ=Europe/Berlin
    networks:
      pentest_lab:
        ipv4_address: 10.5.0.104
    hostname: webgoat
    volumes:
      - webgoat-data:/home/webgoat
  tiredful:
    labels:
      class: 'victim'
      cluster: 'pentest_lab'
      level: 'beginner'
    image: tuxotron/tiredful-api
    ports:
      - '8000:8000'
    networks:
      pentest_lab:
        ipv4_address: 10.5.0.103
    hostname: tiredful
  hackazon:
    labels:
      class: 'victim'
      cluster: 'pentest_lab'
      level: 'beginner'
    image: ianwijaya/hackazon
    ports:
      - '8081:80'
    networks:
      pentest_lab:
        ipv4_address: 10.5.0.102
    hostname: hackazon
  ninjas:
    labels:
      class: 'victim'
      cluster: 'pentest_lab'
      level: 'intermediate'
    image: opendns/security-ninjas
    ports:
      - '8010:80'
    networks:
      pentest_lab:
        ipv4_address: 10.5.0.106
    hostname: ninjas
  juice-shop:
    labels:
      class: 'victim'
      cluster: 'pentest_lab'
      level: 'expert'
    image: bkimminich/juice-shop
    ports:
      - '3000:3000'
    networks:
      pentest_lab:
        ipv4_address: 10.5.0.105
    hostname: juice-shop

volumes:
  kali-data:
  prometheus-data:
  grafana-data:
  bwapp-data:
  webgoat-data:
